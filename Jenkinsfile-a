
def doAwsStuff() {
   withCredentials([usernamePassword(credentialsId: 'test', passwordVariable: 'PASSWORD', usernameVariable: 'USER')]) {
     return ['111',"${PASSWORD}","${USER}"]
   }
}
  

node ('master') {
def pppp= '1234'
  

properties([parameters([[$class: 'ChoiceParameter', choiceType: 'PT_SINGLE_SELECT', description: 'Docker didresolver tag', filterLength: 1, filterable: false, name: 'tag', randomName: 'choice-parameter-87316749809268', script: [$class: 'GroovyScript', fallbackScript: [classpath: [], sandbox: false, script: 'return [\'ppp\']'], script: [classpath: [], sandbox: false, script: """
import jenkins.model.*
import groovy.json.JsonSlurper

def creds = com.cloudbees.plugins.credentials.CredentialsProvider.lookupCredentials(
  com.cloudbees.plugins.credentials.common.StandardUsernameCredentials.class, Jenkins.instance, null, null ).find{
    it.id == 'jenkins_nexus_creds'}
def response = ("curl https://"+creds.username+":"+creds.password+"@nexus.iroha.tech/service/rest/beta/search?docker.imageName=sora-middleware/didresolver").execute().text
def slurper = new JsonSlurper()
def tags = slurper.parseText(response)

return tags.items.version.sort()
  """]]]])])

 stage('all'){
    sh "env"
  }
}
  
